define(function(require,exports,module){var e=require("baseView/tableContent"),i=require("component/popupTip"),t=jQuery,l=e.extend({events:{"click .detail-order":"onClickDetailOrder","click #allExpand":"onClickAllExpand"},orderDetailTmplFunc:_.template(t("#orderDetailTmpl").html()),initialize:function(){l.__super__.initialize.call(this),this.on("refreshdata.tablelist",function(){this.$("#allExpand").html("全部展开")})},onClickDetailOrder:function(e){var i=t(e.target).parents(".record-item"),l=this.extractOptFromDom(i);return null==l.billingPlanUuid?void console.error("billingPlanUuid is not exsit"):void(i.hasClass("z-active")?this.hideOrderDetail(l):this.showOrderDetail(l))},onClickAllExpand:function(e){var i=this,l=t(e.target);"全部展开"===l.text()?(l.text("全部收起"),this.tableListEl.find(".record-item").each(function(){var e=t(this),l=i.extractOptFromDom(e);return null==l.billingPlanUuid?void console.error("billingPlanUuid is not exsit"):void(e.hasClass("z-active")||i.showOrderDetail(l))})):(l.text("全部展开"),this.tableListEl.find(".record-item").each(function(){var e=t(this),l=i.extractOptFromDom(e);i.hideOrderDetail(l)}))},showOrderDetail:function(e){var i=this,t=function(t){var l=i.orderDetailTmplFunc(t);e.el.addClass("z-active").after(l),e.el.find(".detail-order").text("收起")};this.getOrderList(e.billingPlanUuid,t)},hideOrderDetail:function(e){e.el.next(".item-nest").remove(),e.el.removeClass("z-active"),e.el.find(".detail-order").text("详情")},extractOptFromDom:function(e){var i={billingPlanUuid:t(e).data("billingplanuuid"),el:e};return i},getOrderList:function(e,l){var n="./voucher/query/",r={billingPlanUuid:e},a=function(e){0!=e.code?i.show(e.message):l(e.data)};t.getJSON(n,r,a)}});exports.BillingPlanSearchView=l});