define(function(require,exports,module){var e=require("baseView/tableContent"),o=require("component/popupTip"),t=jQuery,i=global_config.root,n=e.extend({initialize:function(){n.__super__.initialize.call(this,arguments),this.initDateTimePicker(),t(window).on("click",function(){t("body").find(".popover").last().hasClass("clickShow")&&t("body").find(".popover").popover("hide")})},initDateTimePicker:function(){t(".datetimepicker-form-control").css("width","135")},events:{"click .icon-bankcard":"onClickBankcard","mouseover .showPopover":"showPopover","mouseout .showPopover":"showPopover","click #exportData":"clickExportData"},actions:{"export":i+"/capital/plan/execlog/export"},showPopover:function(e){var o=t(e.target),i=o.siblings(".account").html();o.popover({content:i}),o.popover("toggle")},onClickBankcard:function(e){e.preventDefault(),this.showPopover(e);var o=t(e.target);return o.on("shown.bs.popover",function(){t("body").find(".popover").last().addClass("clickShow")}),o.on("hidden.bs.popover",function(){o.removeClass("active")}),o.toggleClass("active"),!1},checkDate:function(){var e=t(".starttime-datepicker").last(),i=e.find(".datetimepicker-form-control").first().val();if(_.isEmpty(i))return o.show("请选择起始日期"),!1;var n=t(".endtime-datepicker").last(),a=n.find(".datetimepicker-form-control").first().val(),r=new Date(i),c=new Date(a),s=c.getTime()-r.getTime();return s>6048e5?(o.show("不允许时间间隔超过7天"),!1):!0},clickExportData:function(e){if(e.preventDefault(),this.checkDate()){var n=t("#myForm").serialize(),a={url:this.actions["export"],type:"post",dataType:"json",data:n};a.success=function(e){0==e.code?window.location.href=i+"/capital/plan/execlog/export?"+n:o.show(e.message)},t.ajax(a)}}});module.exports=n});