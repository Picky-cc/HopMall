define(function(require,exports,module){var e=Backbone.Model.extend({initialize:function(e,t){this.sourceModel=t.sourceModel||{},this.options=t},getContractDeadLine:function(){return this.sourceModel.contractBasicInfo.toJSON()},isEqualContractStartDate:function(){var e=this.getContractDeadLine(),t="缴租第一阶段的开始日期必须等于合同开始日期";return e.effectiveTime!==this.get("startDate")?(this.trigger("payperiod:validate",!1,t),!1):(this.trigger("payperiod:validate",!0),!0)},isEqualContractEndDate:function(){var e=this.getContractDeadLine(),t="缴租最后阶段的结束日期必须等于合同结束日期";return e.maturityTime!==this.get("endDate")?(this.trigger("payperiod:validate",!1,t),!1):(this.trigger("payperiod:validate",!0),!0)},validateStageDate:function(){var e=this.toJSON(),t=this.getContractDeadLine(),n=t.effectiveTime&&new Date(t.effectiveTime)>new Date(e.startDate),a=t.maturityTime&&new Date(t.maturityTime)<new Date(e.endDate),i="缴租阶段应在合同期限之内";return n||a?(this.trigger("payperiod:validate",!1,i),!1):(this.trigger("payperiod:validate",!0),!0)}}),t=Backbone.Model.extend({getAllClauseTypes:function(){var e=JSON.parse($("#supplementaryNameAliasMap").val()||"{}"),t=[];for(var n in e)t.push({value:n,name:e[n]});return t},getSelectedClauseTypes:function(){var e=this.collection.toJSON();return e},getRemainClauseTypes:function(){var e=this.getSelectedClauseTypes()||[],t=this.getAllClauseTypes(),n=this.get("clauseType"),a=_.filter(t,function(t){if(t.value===n)return!0;var a=_.find(e,{clauseType:t.value});return!a});return a}}),n=Backbone.Model.extend({initialize:function(e,t){this.sourceModel=t.sourceModel||{}},getContractDeadLine:function(){return this.sourceModel.contractBasicInfo.toJSON()},validateStageDate:function(){var e=this.toJSON(),t=this.getContractDeadLine(),n=t.effectiveTime&&new Date(t.effectiveTime)>new Date(e.startDate),a=t.maturityTime&&new Date(t.maturityTime)<new Date(e.endDate);return n||a?(this.trigger("freerentperiod:validate",!1,"免租期阶段应在合同期限之内"),!1):(this.trigger("freerentperiod:validate",!0),!0)}}),a=Backbone.Model.extend({urlRoot:"./",idAttribute:"businessContractUuid",initialize:function(e,t){this.subjectMatterInfo=new Backbone.Model,this.contractBasicInfo=new Backbone.Model,this.renterInfo=new Backbone.Model,this.paymentInfo=new Backbone.Model,this.attachmentInfo=new Backbone.Model},parse:function(e){if(0==e.code){var t=e.data;return this.fillInternalModel(t),t}},fillInternalModel:function(e){e.paymentInfo&&(e.paymentInfo.supplementaryTermInfo=e.supplementaryTermInfo),this.subjectMatterInfo.set(e.subjectMatterInfo),this.contractBasicInfo.set(e.contractBasicInfo),this.renterInfo.set(e.renterInfo),this.paymentInfo.set(e.paymentInfo),this.attachmentInfo.set(e.attachmentInfo)},saveAll:function(e){var t=this.paymentInfo.toJSON(),n=t.supplementaryTermInfo;t.supplementaryTermInfo=null,this.set({subjectMatterInfo:this.subjectMatterInfo.toJSON(),contractBasicInfo:this.contractBasicInfo.toJSON(),renterInfo:this.renterInfo.toJSON(),attachmentInfo:this.attachmentInfo.toJSON(),paymentInfo:t,supplementaryTermInfo:n}),this.save({},e)}});exports.RentalContractModel=a,exports.PayStageItemModel=e,exports.ExtraRuleItemModel=t,exports.FreeRentStageItemModel=n});