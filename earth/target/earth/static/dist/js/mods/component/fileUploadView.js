define(function(require,exports,module){function e(e){e.outerHTML?e.outerHTML='<input type="file" name="" id="fileInput">':$(e).parent().html('选择文件 <input type="file" name="" id="fileInput">')}var i=require("scaffold/path"),t=require("./popupTip"),n=Backbone.View.extend({el:".file-btn",events:{"change #fileInput":"fileUploadChange"},initialize:function(e){e||(e={}),this.single=e.single,this.fileFilter=e.fileFilter||[],e.single?this.file={}:this.files={}},deleteFile:function(i,t){var n,l=this.$("#fileInput")[0];this.single?(n=this.file,this.file={},e(l)):(n=this.files[i],delete this.files[i]),t&&t(n),n&&this.trigger("delete:fileupload",n)},addFile:function(e){this.single?this.file=e:this.files[e.name]=e,this.trigger("add:fileupload",e)},getHadUploadFiles:function(){return this.single?this.file:this.files},fileUploadChange:function(n){function l(e){return e.files?e.files[0]:(s.supportFilesObject=!1,{name:e.value})}var s=this,f=l(n.target);if(f){var a=i.extname(f.name),o=this.fileFilter;o.length>0&&-1===o.indexOf(a)?t.show("资产文档上传暂只支持.xls与.xlsx文件！"):this.addFile(f),e(this.$("#fileInput")[0])}},exist:function(e){return this.single?this.file.name===e:!!this.files[e]}},{post:function(e){var i=function(){},t={type:"post",dataType:"json",contentType:!1,processData:!1,success:i},n=$.extend({},t,e);if(!n.url)throw"没有文件的上传URL";FormData?$.ajax(n):console.warn("不支持FormData")}});module.exports=n});