define(function(require,exports,module){var e=require("baseView/baseFormView").FormDialogView,t=require("component/popupTip"),i=global_config.root,o=jQuery,n=e.extend({template:_.template(o("#modifyPenaltyTmpl").html(),{variable:"obj"}),actions:{submit:function(e){return i+"/payment-manage/order/"+e+"/edit"}},initialize:function(){n.__super__.initialize.call(this,arguments),this.defineValidator()},defineValidator:function(){this.validator=this.$(".form").validate({rules:{comment:{required:!0,maxlength:50}}})},validate:function(){return this.validator.form()},save:function(){var e=this,t=this.extractDomData();t.orderId=this.model.get("orderId");var i={url:this.actions.submit(this.model.get("orderId")),type:"post",dataType:"json",data:t};i.success=function(i){0==i.code,e.model.trigger("modify:penaltyAmount",t,i)},o.ajax(i)},submitHandler:function(){this.validate()&&(this.save(),this.hide())}}),a=Backbone.View.extend({el:".content",events:{"click #modifyPenalty":"onClickModifyPenalty"},initialize:function(e){this.initModel(e.orderId)},initModel:function(e){var t={};t.penalty=+this.$(".penalty-amount").data("value"),t.comment=this.$(".comment").text().trim(),t.orderId=e,t.assetRecycleDate=this.$(".asset-recycle-date").text().trim(),t.customerName=this.$(".customer-name").text().trim(),t.numbersOfOverdueDays=this.$(".numbers-of-overdue-days").text().trim(),this.model=new Backbone.Model(t)},onClickModifyPenalty:function(){var e=new n({model:this.model});this.model.once("modify:penaltyAmount",function(e,i){0==i.code?(t.show("操作成功"),setTimeout(function(){location.reload()},1e3)):t.show(i.message||"操作失败，请重试")}),e.show()}});module.exports=a});